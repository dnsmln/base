---
import '../assets/styles/main.css';
import ImageViewer from '../components/ImageViewer.astro';
import Head from '../components/Head.astro';
import More from '../components/More.astro';
import Navigation from '../components/Navigation.astro';
import { getSeason } from "../utils/dateFormat";
import { SITE_CONFIG } from '../config';

const { entry } = Astro.props;

const title = entry?.data?.title || SITE_CONFIG.siteTitle;
const description = entry?.data?.excerpt || SITE_CONFIG.description;
const date = entry?.data?.date;

const pageTitle = Astro.url.pathname === '/' 
  ? "Words, shapes, and colors"
  : entry?.data?.title 
    ? `${entry.data.title} â€“ Denis Moulin`
    : `Home of Denis Moulin`;

const { Content } = entry ? await entry.render() : { Content: null };
---

<html lang="en">
  <head>
    <Head 
      title={pageTitle}
      description={description}
      ogImage={SITE_CONFIG.ogImage}
    />
  </head>
  <body>
    <main id="main-content">
      <div class="divider divider--h" style="position: fixed; z-index: 9999;"></div>
      {entry ? (
        <section>
          <div class="title">
            {date && <i>{getSeason(date)}</i>}
          </div>
          <div class="content markdown">
            <h1>{title}</h1>
            <Content />
          </div>
        </section>
      ) : (
        <slot />
      )}
      <More />
      <Navigation />
    </main>
    <ImageViewer />
    
  </body>
</html>
